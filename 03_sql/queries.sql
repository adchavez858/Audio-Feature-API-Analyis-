-- create the 'charts' table
-- includes all instances of each song through time

SELECT cs.*, 
	s.artist_id ,
	s.song_id ,
	s.acousticness,
	s.danceability,
	s.duration,
	s.energy,
	s.instrumentalness,
	s.song_key,
	s.liveness,
	s.loudness,
	s.mode,
	s.speechiness,
	s.tempo,
	s.time_signature,
	s.valence,
	s.a_cappella,
	s.acoustic_pop,
	s.adult_standards,
	s.afrofuturism,
	s.alabama_rap,
	s.alberta_country,
	s.album_rock,
	s.alt_z,
	s.alternative_dance,
	s.alternative_hip_hop,
	s.alternative_metal,
	s.alternative_pop,
	s.alternative_rnb,
	s.alternative_rock,
	s.american_folk_revival,
	s.anarcho_punk,
	s.anti_folk,
	s.arkansas_country,
	s.arkansas_hip_hop,
	s.art_pop,
	s.art_rock,
	s.asian_american_hip_hop,
	s.atl_hip_hop,
	s.atl_trap,
	s.atlanta_bass,
	s.austin_singer_songwriter,
	s.australian_country,
	s.australian_dance,
	s.australian_electropop,
	s.australian_hip_hop,
	s.australian_house,
	s.australian_indie,
	s.australian_pop,
	s.australian_talent_show,
	s.bahamian_pop,
	s.barbadian_pop,
	s.baroque_pop,
	s.bass_house,
	s.bass_trap,
	s.bassline,
	s.baton_rouge_rap,
	s.battle_rap,
	s.bedroom_pop,
	s.bedroom_soul,
	s.belgian_dance,
	s.belgian_pop,
	s.bhangra,
	s.big_beat,
	s.big_room,
	s.black_americana,
	s.blues_rock,
	s.bossbeat,
	s.boston_hip_hop,
	s.boston_punk,
	s.boston_rock,
	s.bounce,
	s.bow_pop,
	s.boy_band,
	s.brill_building_pop,
	s.british_invasion,
	s.british_soul,
	s.britpop,
	s.bronx_hip_hop,
	s.brooklyn_drill,
	s.brostep,
	s.bubblegum_dance,
	s.cali_rap,
	s.canadian_celtic,
	s.canadian_contemporary_country,
	s.canadian_contemporary_rnb,
	s.canadian_country,
	s.canadian_hip_hop,
	s.canadian_latin,
	s.canadian_metal,
	s.canadian_old_school_hip_hop,
	s.canadian_pop,
	s.canadian_pop_punk,
	s.canadian_punk,
	s.canadian_rock,
	s.canadian_singer_songwriter,
	s.canadian_trap,
	s.candy_pop,
	s.cartoon,
	s.ccm,
	s.celtic,
	s.celtic_rock,
	s.chamber_pop,
	s.chicago_bop,
	s.chicago_drill,
	s.chicago_indie,
	s.chicago_rap,
	s.chicano_rap,
	s.childrens_music,
	s.chopped_and_screwed,
	s.christian_alternative_rock,
	s.christian_indie,
	s.christian_music,
	s.christian_rock,
	s.chutney,
	s.classic_bhangra,
	s.classic_dubstep,
	s.classic_girl_group,
	s.classic_rock,
	s.clean_comedy,
	s.colombian_pop,
	s.comedy,
	s.comedy_rap,
	s.comic,
	s.complextro,
	s.conscious_hip_hop,
	s.contemporary_country,
	s.contemporary_rnb,
	s.contemporary_vocal_jazz,
	s.country,
	s.country_dawn,
	s.country_gospel,
	s.country_pop,
	s.country_rap,
	s.country_road,
	s.country_rock,
	s.cowboy_western,
	s.cowpunk,
	s.crunk,
	s.cyberpunk,
	s.dance_punk,
	s.dance_pop,
	s.dance_rock,
	s.dancehall,
	s.danish_pop,
	s.dark_clubbing,
	s.dark_pop,
	s.deep_acoustic_pop,
	s.deep_southern_trap,
	s.deep_underground_hip_hop,
	s.derby_indie,
	s.desi_hip_hop,
	s.desi_pop,
	s.destroy_techno,
	s.detroit_hip_hop,
	s.detroit_rock,
	s.dfw_rap,
	s.dirty_south_rap,
	s.disco,
	s.dmv_rap,
	s.dong_yo,
	s.double_drumming,
	s.downtempo,
	s.drill,
	s.dutch_edm,
	s.dutch_pop,
	s.east_coast_hip_hop,
	s.easy_listening,
	s.ectofolk,
	s.edm,
	s.electra,
	s.electro,
	s.electro_house,
	s.electronic_rock,
	s.electronic_trap,
	s.electronica,
	s.electropop,
	s.electropowerpop,
	s.emo,
	s.emo_rap,
	s.escape_room,
	s.etherpop,
	s.eurodance,
	s.europop,
	s.fake,
	s.filter_house,
	s.florida_rap,
	s.folk,
	s.folk_pop,
	s.folk_rock,
	s.french_indie_pop,
	s.french_pop,
	s.french_rock,
	s.funk,
	s.funk_metal,
	s.funk_rock,
	s.futuristic_swag,
	s.g_funk,
	s.gambian_hip_hop,
	s.gangster_rap,
	s.garage_rock,
	s.gauze_pop,
	s.gen_z_singer_songwriter,
	s.german_pop,
	s.german_techno,
	s.ghanaian_hip_hop,
	s.girl_group,
	s.glam_metal,
	s.glam_rock,
	s.glee_club,
	s.golden_age_hip_hop,
	s.gospel,
	s.gospel_rnb,
	s.grime,
	s.grunge,
	s.grunge_pop,
	s.hard_rock,
	s.hardcore_hip_hop,
	s.harlem_hip_hop,
	s.hawaiian_hip_hop,
	s.heartland_rock,
	s.hip_hop,
	s.hip_house,
	s.hip_pop,
	s.hollywood,
	s.house,
	s.houston_rap,
	s.hyphy,
	s.idol,
	s.indie_pop,
	s.indie_pop_rap,
	s.indie_poptimism,
	s.indie_rock,
	s.indie_soul,
	s.indiecoustica,
	s.indietronica,
	s.industrial,
	s.industrial_metal,
	s.industrial_rock,
	s.irish_rock,
	s.irish_singer_songwriter,
	s.italian_adult_pop,
	s.italo_dance,
	s.jam_band,
	s.jamaican_dancehall,
	s.jazz_pop,
	s.k_pop,
	s.k_pop_boy_group,
	s.k_pop_girl_group,
	s.k_rap,
	s.kentucky_hip_hop,
	s.korean_old_school_hip_hop,
	s.la_indie,
	s.latin_hip_hop,
	s.latin_pop,
	s.latin_viral_pop,
	s.lds_youth,
	s.lgbtq_hip_hop,
	s.lilith,
	s.lounge,
	s.lovers_rock,
	s.madchester,
	s.maine_hip_hop,
	s.medieval_folk,
	s.melancholia,
	s.melbourne_bounce_international,
	s.mellow_gold,
	s.melodic_dubstep,
	s.melodic_rap,
	s.memphis_hip_hop,
	s.metal,
	s.metropopolis,
	s.mexican_classic_rock,
	s.mexican_pop,
	s.miami_bass,
	s.miami_hip_hop,
	s.middle_earth,
	s.minneapolis_sound,
	s.minnesota_hip_hop,
	s.mississippi_hip_hop,
	s.modern_alternative_pop,
	s.modern_alternative_rock,
	s.modern_blues_rock,
	s.modern_country_rock,
	s.modern_folk_rock,
	s.modern_indie_pop,
	s.modern_power_pop,
	s.modern_rock,
	s.modern_uplift,
	s.nashville_hip_hop,
	s.neo_singer_songwriter,
	s.neo_synthpop,
	s.neo_mellow,
	s.neo_soul,
	s.neon_pop_punk,
	s.new_jack_swing,
	s.new_jersey_rap,
	s.new_jersey_underground_rap,
	s.new_orleans_rap,
	s.new_rave,
	s.new_romantic,
	s.new_wave,
	s.new_wave_pop,
	s.ninja,
	s.north_carolina_hip_hop,
	s.norwegian_pop,
	s.nouvelle_chanson_francaise,
	s.nu_metal,
	s.nyc_rap,
	s.nz_pop,
	s.oakland_hip_hop,
	s.ohio_hip_hop,
	s.oklahoma_country,
	s.old_school_atlanta_hip_hop,
	s.old_school_dancehall,
	s.old_school_hip_hop,
	s.old_school_thrash,
	s.omaha_indie,
	s.operatic_pop,
	s.orchestral_soundtrack,
	s.outlaw_country,
	s.oxford_indie,
	s.panamanian_pop,
	s.permanent_wave,
	s.philly_rap,
	s.piano_rock,
	s.pittsburgh_rap,
	s.pixie,
	s.plugg,
	s.pluggnb,
	s.political_hip_hop,
	s.pop,
	s.pop_dance,
	s.pop_emo,
	s.pop_punk,
	s.pop_rnb,
	s.pop_rap,
	s.pop_rock,
	s.pop_soul,
	s.post_grunge,
	s.post_teen_pop,
	s.power_pop,
	s.progressive_electro_house,
	s.progressive_house,
	s.puerto_rican_pop,
	s.punk,
	s.punk_blues,
	s.queens_hip_hop,
	s.queer_country,
	s.quiet_storm,
	s.rnb,
	s.rap,
	s.rap_conscient,
	s.rap_kreyol,
	s.rap_latina,
	s.rap_metal,
	s.rap_rock,
	s.redneck,
	s.reggae_fusion,
	s.reggaeton,
	s.reggaeton_colombiano,
	s.reggaeton_flow,
	s.rhode_island_rap,
	s.rock,
	s.rock_and_roll,
	s.rock_drums,
	s.rockabilly,
	s.romanian_house,
	s.romanian_pop,
	s.roots_reggae,
	s.sad_rap,
	s.salsa,
	s.san_diego_rap,
	s.scam_rap,
	s.scandipop,
	s.scottish_singer_songwriter,
	s.screamo,
	s.seattle_hip_hop,
	s.seattle_indie,
	s.shimmer_pop,
	s.shiver_pop,
	s.shoegaze,
	s.show_tunes,
	s.singer_songwriter,
	s.ska,
	s.ska_punk,
	s.skate_punk,
	s.slap_house,
	s.sleaze_rock,
	s.soca,
	s.socal_pop_punk,
	s.soft_rock,
	s.solo_wave,
	s.sophisti_pop,
	s.soul,
	s.soul_flow,
	s.soundtrack,
	s.south_african_pop,
	s.south_african_rock,
	s.south_carolina_hip_hop,
	s.southern_hip_hop,
	s.st_louis_rap,
	s.stomp_and_holler,
	s.stomp_pop,
	s.supergroup,
	s.swedish_electropop,
	s.swedish_pop,
	s.swedish_synthpop,
	s.swing,
	s.synthpop,
	s.talent_show,
	s.tennessee_hip_hop,
	s.texas_country,
	s.texas_latin_rap,
	s.texas_pop_punk,
	s.thrash_metal,
	s.toronto_rap,
	s.traditional_country,
	s.trancecore,
	s.trap,
	s.trap_boricua,
	s.trap_latino,
	s.trap_queen,
	s.trip_hop,
	s.tropical,
	s.tropical_house,
	s.turntablism,
	s.uk_alternative_pop,
	s.uk_americana,
	s.uk_contemporary_rnb,
	s.uk_dance,
	s.uk_funky,
	s.uk_garage,
	s.uk_pop,
	s.underground_hip_hop,
	s.upstate_ny_rap,
	s.urban_contemporary,
	s.vapor_trap,
	s.vapor_twitch,
	s.vincy_soca,
	s.viral_pop,
	s.viral_rap,
	s.viral_trap,
	s.virginia_hip_hop,
	s.vocal_house,
	s.vocal_jazz,
	s.washington_indie,
	s.west_coast_rap,
	s.world,
	s.worship,
	s.yacht_rock,
	s.yakut_pop,
	s.yodeling,
	s.all_pop,
	s.all_rock,
	s.all_hiphop,
	s.all_metal,
	s.top3_genres,
	s.not_top3
INTO charts
FROM charts_spine cs
LEFT JOIN songs s
ON cs.combo = s.combo;